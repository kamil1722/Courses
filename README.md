Я внес одну корректировку в скрипт БД , возможно это ошибка проектирования БД или я чего то не понимаю. 
Но суть в том, что ParentID в таблице модулей, принимал изначально значения Null с типом int, что в свою очередь не обрабатывается циклом. Тут два варианта решения, либо поставить
вместо int ,например, varchar и  или поставить not null и несуществующие id курсов
